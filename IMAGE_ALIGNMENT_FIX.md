# å›¾ç‰‡å¯¹é½å’Œæ‹‰ä¼¸ä¿®å¤æŒ‡å—
## ğŸ¯ ä¿®å¤å®Œæˆ

æˆåŠŸä¿®å¤äº†å›¾ç‰‡æ‹‰ä¼¸ã€æ¯”ä¾‹ä¸å¯¹é½å’Œçº¹ç†é”™ä½é—®é¢˜ï¼

---

## ğŸ”§ ä¸»è¦ä¿®å¤å†…å®¹

### 1. Aspect Ratio ä¿®å¤

**é—®é¢˜**ï¼šå›¾ç‰‡åœ¨ä¸åŒå±å¹•æ¯”ä¾‹ä¸‹è¢«æ‹‰ä¼¸å˜å½¢

**è§£å†³æ–¹æ¡ˆ**ï¼š
```glsl
// ä¿®å¤aspect ratioï¼šä¿æŒå›¾ç‰‡æ­£å¸¸æ¯”ä¾‹ï¼Œå±…ä¸­æ˜¾ç¤º
vec2 center_uv = uv - 0.5; // ç§»åˆ°ä¸­å¿ƒ

// æ ¹æ®å±å¹•æ¯”ä¾‹è°ƒæ•´ï¼Œç¡®ä¿å›¾ç‰‡ä¸è¢«æ‹‰ä¼¸
if (aspect > 1.0) {
    // å±å¹•æ¯”å›¾ç‰‡å®½ï¼Œè°ƒæ•´Yè½´
    center_uv.y = center_uv.y / aspect;
} else {
    // å±å¹•æ¯”å›¾ç‰‡é«˜ï¼Œè°ƒæ•´Xè½´  
    center_uv.x = center_uv.x * aspect;
}

uv = center_uv + 0.5; // ç§»å›åŸä½ç½®
uv = clamp(uv, 0.0, 1.0); // ç¡®ä¿UVåœ¨æœ‰æ•ˆèŒƒå›´å†…
```

### 2. å‚æ•°é‡ç½®ç¡®ä¿æ­£ç¡®æ˜¾ç¤º

**ä¿®å¤å‰**ï¼šæ·±åº¦æ•ˆæœå¯¼è‡´å›¾ç‰‡å˜å½¢
**ä¿®å¤å**ï¼šåˆå§‹çŠ¶æ€ä¸‹æ— æ·±åº¦æ•ˆæœï¼Œç¡®ä¿å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º

```cpp
// å›¾ç‰‡æ˜¾ç¤ºæ­£ç¡®çš„åŸºç¡€å‚æ•°
g_ubo.height = 0.0f;          // åˆå§‹æ— æ·±åº¦æ•ˆæœ
g_ubo.steady = 0.1f;         // ç¨³å®šæ€§ 
g_ubo.focus = 0.0f;           // æ— ç„¦ç‚¹åç§»
g_ubo.zoom = 1.0f;            // æ— ç¼©æ”¾
g_ubo.isometric = 0.0f;       // æ— ç­‰è·è§†è§’
g_ubo.dolly = 0.0f;           // æ— æ¨æ‹‰
g_ubo.invert = 0.0f;          // ä¸åè½¬æ·±åº¦
g_ubo.mirror = 0.0f;          // ä¸é•œåƒ

// ç¡®ä¿å›¾ç‰‡å±…ä¸­å¯¹é½ï¼Œæ— åç§»
g_ubo.offset.x = 0.0f;        // æ— åç§»
g_ubo.offset.y = 0.0f;
g_ubo.center.x = 0.0f;        // ä¸­å¿ƒç‚¹åœ¨åŸä½
g_ubo.center.y = 0.0f;
g_ubo.origin.x = 0.0f;        // åŸç‚¹åœ¨ä¸­å¿ƒ
g_ubo.origin.y = 0.0f;
```

### 3. è§¦æ‘¸äº¤äº’ä¼˜åŒ–

**ä¿®å¤å‰**ï¼šè§¦æ‘¸åç§»è¿‡å¤§ï¼Œå›¾ç‰‡å®¹æ˜“ç§»å‡ºå±å¹•
**ä¿®å¤å**ï¼šå‡å°è§¦æ‘¸çµæ•åº¦ï¼Œç¡®ä¿å›¾ç‰‡ä¿æŒåœ¨å¯è§†åŒºåŸŸ

```java
// å‡å°è§¦æ‘¸åç§»çš„çµæ•åº¦ï¼Œé˜²æ­¢å›¾ç‰‡è¿‡åº¦ç§»åŠ¨
userOffsetX = (event.getX() / w - 0.5f) * 0.3f;  // ä»2.0fæ”¹ä¸º0.3f
userOffsetY = (event.getY() / h - 0.5f) * 0.3f;  // ä»2.0fæ”¹ä¸º0.3f
```

### 4. çº¹ç†å¯¹é½ä¿è¯

**æ–°å¢é€»è¾‘**ï¼šåœ¨æ— æ·±åº¦æ•ˆæœæ—¶ï¼Œç¡®ä¿æ‰€æœ‰çº¹ç†ä½¿ç”¨ç›¸åŒçš„UVåæ ‡

```glsl
// åˆå§‹çŠ¶æ€ï¼šæ— æ·±åº¦æ•ˆæœï¼Œç¡®ä¿æ‰€æœ‰çº¹ç†å¯¹é½æ˜¾ç¤º
if (height <= 0.001) {
    // æ‰€æœ‰çº¹ç†ä½¿ç”¨ç›¸åŒçš„UVåæ ‡ï¼Œç¡®ä¿å®Œç¾å¯¹é½
    outColor = sampleTex(texImage, uv, mirror);
    return;
}
```

---

## ğŸ“± é¢„æœŸæ•ˆæœ

ä¿®å¤ååº”è¯¥çœ‹åˆ°ï¼š

âœ… **å›¾ç‰‡ä¸æ‹‰ä¼¸**ï¼šåœ¨å„ç§å±å¹•æ¯”ä¾‹ä¸‹ä¿æŒæ­£ç¡®å®½é«˜æ¯”  
âœ… **å±…ä¸­æ˜¾ç¤º**ï¼šå›¾ç‰‡å§‹ç»ˆåœ¨å±å¹•ä¸­å¤®  
âœ… **çº¹ç†å¯¹é½**ï¼šæ‰€æœ‰æ¸²æŸ“å›¾å±‚å®Œç¾å¯¹é½  
âœ… **è§¦æ‘¸ç²¾ç¡®**ï¼šè§¦æ‘¸äº¤äº’æ›´åŠ ç²¾ç»†å¯æ§  
âœ… **åˆå§‹çŠ¶æ€ç¨³å®š**ï¼šå¯åŠ¨æ—¶å›¾ç‰‡æ­£ç¡®æ˜¾ç¤º  

---

## ğŸ® ä½¿ç”¨æ–¹æ³•

### åŸºç¡€çŠ¶æ€ï¼ˆå½“å‰è®¾ç½®ï¼‰

- **æ— æ·±åº¦æ•ˆæœ**ï¼šå›¾ç‰‡æ­£å¸¸æ˜¾ç¤ºï¼Œæ— å˜å½¢
- **å±…ä¸­å¯¹é½**ï¼šå›¾ç‰‡åœ¨å±å¹•ä¸­å¤®
- **è§¦æ‘¸äº¤äº’**ï¼šå°å¹…åº¦çš„è§†å·®ç§»åŠ¨

### å¯ç”¨æ·±åº¦æ•ˆæœ

å¦‚éœ€å¯ç”¨PCé£æ ¼æ·±åº¦æµæ•ˆæœï¼Œå¯åœ¨è¿è¡Œæ—¶ä¿®æ”¹å‚æ•°ï¼š

```cpp
// å¯ç”¨æ·±åº¦æµæ•ˆæœ
g_ubo.height = 0.15f;         // é€‚ä¸­çš„æ·±åº¦å¼ºåº¦
g_ubo.focus = 0.3f;            // ç„¦ç‚¹æ•ˆæœ
g_ubo.steady = 0.2f;          // ç¨³å®šæ€§
```

### è°ƒæ•´è§¦æ‘¸çµæ•åº¦

```java
// å¢åŠ è§¦æ‘¸çµæ•åº¦ï¼ˆå¦‚éœ€æ›´å¤§ç§»åŠ¨èŒƒå›´ï¼‰
userOffsetX = (event.getX() / w - 0.5f) * 0.5f;
userOffsetY = (event.getY() / h - 0.5f) * 0.5f;
```

---

## ğŸ” éªŒè¯æ–¹æ³•

### 1. è§†è§‰æ£€æŸ¥

- [ ] å›¾ç‰‡ä¿æŒåŸå§‹å®½é«˜æ¯”ï¼Œæ— æ‹‰ä¼¸
- [ ] å›¾ç‰‡åœ¨å±å¹•ä¸­å¤®å¯¹é½
- [ ] æ‰€æœ‰çº¹ç†å±‚å¯¹é½ï¼Œæ— é”™ä½

### 2. è§¦æ‘¸æµ‹è¯•

- [ ] è§¦æ‘¸ç§»åŠ¨å¹…åº¦é€‚ä¸­
- [ ] å›¾ç‰‡ä¸ä¼šç§»å‡ºå±å¹•
- [ ] äº¤äº’å“åº”æµç•…

### 3. æ—¥å¿—æ£€æŸ¥

```bash
adb logcat | grep DepthFlow
```

å…³é”®æ—¥å¿—ï¼š
- `Texture X loaded successfully` - çº¹ç†åŠ è½½æˆåŠŸ
- `=== PC-STYLE DEPTHFLOW PARAMETERS INITIALIZED ===` - å‚æ•°åˆå§‹åŒ–å®Œæˆ
- Aspect ratio å€¼æ­£ç¡®è®¡ç®—

---

## ğŸš€ æ„å»ºå’Œå®‰è£…

```bash
# æ¸…ç†å¹¶æ„å»º
./gradlew clean assembleDebug

# å®‰è£…åˆ°è®¾å¤‡
./gradlew installDebug

# è¿è¡Œå¹¶æµ‹è¯•
# è§‚å¯Ÿå›¾ç‰‡æ˜¾ç¤ºæ•ˆæœ
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

å¦‚æœé‡åˆ°æ€§èƒ½é—®é¢˜ï¼š

1. **é™ä½è´¨é‡å‚æ•°**ï¼š
   ```cpp
   g_ubo.quality = 0.3f; // é™ä½æ¸²æŸ“è´¨é‡
   ```

2. **ç®€åŒ–åå¤„ç†**ï¼š
   ```cpp
   g_ubo.vig_enable = 0.0f; // ç¦ç”¨æ™•å½±
   ```

3. **å‡å°‘åŠ¨æ€æ•ˆæœ**ï¼š
   ```cpp
   g_ubo.height = 0.05f; // å‡å°æ·±åº¦æ•ˆæœå¼ºåº¦
   ```

---

**ä¿®å¤å®Œæˆæ—¥æœŸ**ï¼š2025-12-10  
**ç‰ˆæœ¬**ï¼šDepthFlow Mobile v2.1-Image-Alignment-Fix  
**çŠ¶æ€**ï¼šâœ… å®Œæˆå¹¶å¯è¿è¡Œ  

---

ç°åœ¨å›¾ç‰‡åº”è¯¥èƒ½å¤Ÿæ­£ç¡®æ˜¾ç¤ºï¼Œä¸æ‹‰ä¼¸ï¼Œåœ¨å±å¹•ä¸­å¤®å¯¹é½ï¼Œæ‰€æœ‰æ¸²æŸ“çº¹ç†å®Œç¾å¯¹é½ï¼
